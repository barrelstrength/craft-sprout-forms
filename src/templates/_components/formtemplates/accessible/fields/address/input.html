{# This will wrap the generated HTML for all the address fields #}
<div class="sproutaddress-form">
    {# The select.html file is used for the Country dropdown fields. It will also be used used for the Region dropdown fields if hey exist, in the {{ form }} output below. #}
    {{ countryInput }}

    {# The form output will include several fields that use the text.html and select.html fields. #}

    {{ form }}
    {# the hidden.html file will be output here ??? #}
</div>
<script>
    function loadAdministrativeArea(url, el, namespace) {
        //console.log(findAncestor(el, 'form'));

        var oForm = el.closest('form');

        var csrfValue = oForm.elements["{{ csrfTokenName  }}"].value;

        var http = new XMLHttpRequest();

       // var params = "cc=" + namespace + "&countryCode="+el.value;
        var data = {name: namespace, countryCode: el.value};
        var params = typeof data == 'string' ? data : Object.keys(data).map(
            function(k){ return encodeURIComponent(k) + '=' + encodeURIComponent(data[k]) }
        ).join('&');

        http.open('POST', url, true);

        http.setRequestHeader('X-CSRF-Token', csrfValue);

        http.onreadystatechange = function() {

            //Call a function when the state changes.
            if(http.readyState == 4 && http.status == 200) {
                console.log(http.response)
            }
        };
        http.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        http.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        http.send(params);
    }
</script>